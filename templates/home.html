{% extends 'base.html' %}

{% load static %}

{% block title %}Home{% endblock %}
{% block content %}


<!-- Hero Section: First Featured Post -->
{% for post in featured_posts %}
  {% if forloop.first %}
  <section class="py-5 text-white position-relative overflow-hidden" 
           style="background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('{{ post.featured_image.url }}') center/cover no-repeat; min-height: 80vh;">
    <div class="container h-100 d-flex align-items-center">
      <div class="col-lg-7 col-xl-6">
        <h1 class="display-4 fw-bold mb-3">{{ post.title }}</h1>
        <p class="lead mb-4">{{ post.short_description|truncatewords:30 }}</p>
        <a href="{% url 'blogs' post.slug %}" class="btn btn-warning btn-lg fw-bold text-dark">
          Continue Reading →
        </a>
      </div>
    </div>
  </section>
  {% endif %}
{% endfor %}

<!-- Featured Posts Section -->
{% if featured_posts|length > 1 %}
<div class="container my-5">
  <h2 class="text-uppercase text-warning fw-bold mb-4" style="letter-spacing: 2px;">Featured Posts</h2>
  <div class="row g-4">
    {% for post in featured_posts %}
      {% if not forloop.first %}
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 border-0 shadow-sm hover-shadow transition">
          {% if post.featured_image %}
          <img src="{{ post.featured_image.url }}" class="card-img-top" alt="{{ post.title }}" style="height: 200px; object-fit: cover;">
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h5 class="card-title fw-bold">
              <a href="{% url 'blogs' post.slug %}" class="text-dark text-decoration-none stretched-link">{{ post.title }}</a>
            </h5>
            <p class="text-muted small mb-2">{{ post.created_at|timesince }} ago | {{ post.author }}</p>
            <p class="card-text flex-grow-1">{{ post.short_description|truncatewords:25 }}</p>
          </div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
  </div>
</div>
{% endif %}

<!-- Recent Articles + Sidebar -->
<div class="container my-5">
  <h2 class="text-uppercase text-warning fw-bold mb-4" style="letter-spacing: 2px;">Recent Articles</h2>
  <div class="row g-5">
    <!-- Main Content -->
    <main class="col-lg-8">
      {% for post in page_obj %}
      <article class="card border-0 mb-4 shadow-sm hover-shadow transition">
        <div class="card-body">
          <h3 class="fw-bold mb-2">
            <a href="{% url 'blogs' post.slug %}" class="text-dark text-decoration-none">{{ post.title }}</a>
          </h3>
          <p class="text-muted small mb-3">{{ post.created_at|timesince }} ago | {{ post.author }}</p>
          <p class="lead">{{ post.short_description|truncatewords:40 }}</p>
          <a href="{% url 'blogs' post.slug %}" class="text-primary fw-bold text-decoration-none">Read more →</a>
        </div>
      </article>
      {% empty %}
      <p class="text-muted">No recent articles available.</p>
      {% endfor %}

{% if page_obj.has_other_pages %}
<div class="container mt-5">
    <nav aria-label="Recent posts pagination">
        <ul class="pagination justify-content-center">
            <!-- Previous -->
            {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">Previous</span>
            </li>
            {% endif %}

            <!-- Page numbers -->
            {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                <li class="page-item active">
                    <span class="page-link">{{ num }}</span>
                </li>
                {% elif num >= page_obj.number|add:"-2" and num <= page_obj.number|add:"2" %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                </li>
                {% endif %}
            {% endfor %}

            <!-- Next -->
            {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">Next</span>
            </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endif %}
    </main>

    

    <!-- Sidebar -->
    <aside class="col-lg-4">
      <!-- About Widget -->
       
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
          <h5 class="card-title fw-bold">{{ about.about_heading }}</h5>
          <p class="card-text text-muted">{{ about.about_description }}</p>
        </div>
      </div>

      <!-- Categories Widget -->
    <div class="card mb-4 border-0 shadow-sm">
        <div class="card-header bg-dark text-white py-3">
            <h5 class="mb-0 fw-bold">Categories</h5>
        </div>
        <div class="card-body">
            <ul class="list-unstyled mb-0">
                {% for cat in categories %}
                <li class="mb-2">
                    <a href="{% url 'posts_by_category' cat.id %}" 
                       class="text-decoration-none text-dark hover-link">
                        {{ cat.category_name }}
                    </a>
                </li>
                {% empty %}
                <li class="text-muted">No categories available</li>
                {% endfor %}
            </ul>
        </div>
    </div>

      <!-- Social Links Widget -->
      {% if social_links %}
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-dark text-white">
          <h5 class="mb-0 fw-bold">Follow Us</h5>
        </div>
        <div class="card-body">
          <ul class="list-unstyled mb-0">
            {% for link in social_links %}
            <li class="mb-3">
              <a href="{{ link.link }}" target="_blank" rel="noopener" 
                 class="d-flex align-items-center text-decoration-none text-dark fw-medium">
                <i class="bi bi-{{ link.platform|lower }} me-3 fs-4 text-dark"></i>
                {{ link.platform|title }}
              </a>
            </li>
            {% endfor %}
          </ul>
        </div>
      </div>
      {% endif %}
    </aside>
  </div>
</div>




{% endblock %}